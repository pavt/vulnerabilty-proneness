import pandas as pd
import os

class VulnerabilityDataLoader:
    def __init__(self, source_file, dependencies_file, results_path="results/"):
        self.source_file = source_file
        self.dependencies_file = dependencies_file
        self.results_path = results_path
        os.makedirs(self.results_path, exist_ok=True)  # Ensure the results directory exists
    
    def load_data(self):
        """
        Loads data from the source and dependencies CSV files, then merges them into a single DataFrame.
        """
        df_source = pd.read_csv(self.source_file)
        df_dependencies = pd.read_csv(self.dependencies_file)
        merged_df = pd.concat([df_source, df_dependencies], ignore_index=True)
        
        # Save merged data to results folder
        merged_file = os.path.join(self.results_path, "merged_data.csv")
        merged_df.to_csv(merged_file, index=False)
        print(f"Merged data saved to: {merged_file}")
        
        return merged_df
